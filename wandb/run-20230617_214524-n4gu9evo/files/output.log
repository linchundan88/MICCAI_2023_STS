
using SegResNetDS for training.
  0%|          | 0/954 [00:00<?, ?it/s]
  0%|          | 0/954 [00:00<?, ?it/s]/mnt/d/PROJECTION/TianChi/STS-2D/train.py:71: UserWarning: torch.nn.utils.clip_grad_norm is now deprecated in favor of torch.nn.utils.clip_grad_norm_.
  torch.nn.utils.clip_grad_norm(model.parameters(), CFG.max_grad_norm)
















































































































































































































































































































100%|██████████| 954/954 [10:14<00:00,  1.55it/s, epoch=1, gpu_mem=24.30 GB, loss=0.1284, lr=3.00e-03]
100%|██████████| 6/6 [00:00<00:00, 28.21it/s, epoch=1, gpu_mem=4.87 GB, loss=0.0738]
valid:
100%|██████████| 6/6 [00:00<00:00, 40.95it/s, epoch=1, gpu_mem=4.87 GB, loss=0.0770]
100%|██████████| 6/6 [00:00<00:00, 43.02it/s, epoch=1, gpu_mem=4.87 GB, loss=0.0716]
100%|██████████| 6/6 [00:00<00:00, 40.45it/s, epoch=1, gpu_mem=4.87 GB, loss=0.1540]
best_th=0.3, score up: 0.000000->0.876979
best_th=0.35, score up: 0.876979->0.887603
best_th=0.4, score up: 0.887603->0.897014
best_th=0.45, score up: 0.897014->0.906137
best_th=0.5, score up: 0.906137->0.914309
best_th=0.55, score up: 0.914309->0.922344
best_th=0.6, score up: 0.922344->0.929562
best_th=0.65, score up: 0.929562->0.935302
best_th=0.3, score up: 0.000000->0.934698
best_th=0.35, score up: 0.934698->0.937629
best_th=0.4, score up: 0.937629->0.938947
best_th=0.3, score up: 0.000000->0.931614
best_th=0.35, score up: 0.931614->0.933399
best_th=0.3, score up: 0.000000->0.901918
  0%|          | 0/954 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/mnt/d/PROJECTION/TianChi/STS-2D/train.py", line 193, in <module>
    train_loss = train_step(train_loader, model, criterion, optimizer, CFG.device, epoch)
  File "/mnt/d/PROJECTION/TianChi/STS-2D/train.py", line 70, in train_step
    scaler.scale(loss).backward()
  File "/home/zy/anaconda3/envs/kaggle_torch/lib/python3.9/site-packages/torch/_tensor.py", line 487, in backward
    torch.autograd.backward(
  File "/home/zy/anaconda3/envs/kaggle_torch/lib/python3.9/site-packages/torch/autograd/__init__.py", line 200, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: CUDA error: unknown error
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
train: