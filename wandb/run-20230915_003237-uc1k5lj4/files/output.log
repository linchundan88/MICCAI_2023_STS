using SegResNet_64 for training.
train:
  0%|          | 0/1097 [00:00<?, ?it/s]/mnt/d/PROJECTION/TianChi/STS-2D/train.py:78: UserWarning: torch.nn.utils.clip_grad_norm is now deprecated in favor of torch.nn.utils.clip_grad_norm_.
  torch.nn.utils.clip_grad_norm(model.parameters(), CFG.max_grad_norm)
























































































































































































































































































100%|█████████▉| 1095/1097 [09:28<00:01,  1.93it/s, epoch=1, gpu_mem=22.49 GB, loss=0.0344, lr=3.00e-03]
100%|██████████| 1097/1097 [09:29<00:00,  1.93it/s, epoch=1, gpu_mem=22.49 GB, loss=0.0289, lr=3.00e-03]
100%|██████████| 1/1 [00:00<00:00,  6.64it/s, epoch=1, gpu_mem=1.86 GB, loss=0.0136]
100%|██████████| 1/1 [00:00<00:00,  8.30it/s, epoch=1, gpu_mem=1.86 GB, loss=0.0117]
100%|██████████| 1/1 [00:00<00:00,  7.56it/s, epoch=1, gpu_mem=1.86 GB, loss=0.0191]
best_th=0.3, score up: 0.000000->0.176796
best_th=0.5, score up: 0.176796->0.199656
best_th=0.55, score up: 0.199656->0.573357
best_th=0.6, score up: 0.573357->0.621081
best_th=0.3, score up: 0.000000->0.122219
best_th=0.5, score up: 0.122219->0.161712
best_th=0.55, score up: 0.161712->0.532929
best_th=0.6, score up: 0.532929->0.603656
best_th=0.65, score up: 0.603656->0.614218
best_th=0.3, score up: 0.000000->0.208335
best_th=0.5, score up: 0.208335->0.224737
best_th=0.55, score up: 0.224737->0.583051
best_th=0.6, score up: 0.583051->0.601228
best_th=0.3, score up: 0.000000->0.185003
best_th=0.5, score up: 0.185003->0.199668
best_th=0.55, score up: 0.199668->0.550601
best_th=0.6, score up: 0.550601->0.608983
best_th=0.65, score up: 0.608983->0.626621
best_th=0.3, score up: 0.000000->0.187668
best_th=0.5, score up: 0.187668->0.193706
best_th=0.55, score up: 0.193706->0.528085
best_th=0.6, score up: 0.528085->0.591778
best_th=0.65, score up: 0.591778->0.612823
100%|██████████| 1/1 [00:00<00:00,  8.37it/s, epoch=1, gpu_mem=1.86 GB, loss=0.0185]
100%|██████████| 1/1 [00:00<00:00,  6.61it/s, epoch=1, gpu_mem=1.86 GB, loss=0.0146]
100%|██████████| 1/1 [00:00<00:00,  7.17it/s, epoch=1, gpu_mem=1.86 GB, loss=0.0094]
  0%|          | 0/1097 [00:00<?, ?it/s]
best_th=0.3, score up: 0.000000->0.110346
best_th=0.5, score up: 0.110346->0.148907
best_th=0.55, score up: 0.148907->0.540464
best_th=0.6, score up: 0.540464->0.589926



























































































































































































































































































100%|█████████▉| 1096/1097 [09:26<00:00,  1.94it/s, epoch=2, gpu_mem=22.84 GB, loss=0.0150, lr=3.00e-03]
valid:
best_th=0.3, score up: 0.000000->0.176796
best_th=0.5, score up: 0.176796->0.343842
best_th=0.55, score up: 0.343842->0.603464
100%|██████████| 1097/1097 [09:27<00:00,  1.93it/s, epoch=2, gpu_mem=22.84 GB, loss=0.0125, lr=3.00e-03]
100%|██████████| 1/1 [00:00<00:00,  6.52it/s, epoch=2, gpu_mem=1.97 GB, loss=0.0053]
100%|██████████| 1/1 [00:00<00:00,  7.89it/s, epoch=2, gpu_mem=1.97 GB, loss=0.0063]
100%|██████████| 1/1 [00:00<00:00,  8.28it/s, epoch=2, gpu_mem=1.97 GB, loss=0.0102]
  0%|          | 0/1 [00:00<?, ?it/s, epoch=2, gpu_mem=1.97 GB, loss=0.0111]
best_th=0.3, score up: 0.000000->0.122219
best_th=0.5, score up: 0.122219->0.217762
best_th=0.55, score up: 0.217762->0.573846
best_th=0.6, score up: 0.573846->0.618411
best_th=0.65, score up: 0.618411->0.625613
best_th=0.3, score up: 0.000000->0.208335
best_th=0.5, score up: 0.208335->0.373929
best_th=0.55, score up: 0.373929->0.617351
best_th=0.6, score up: 0.617351->0.626227
best_th=0.3, score up: 0.000000->0.185003
best_th=0.5, score up: 0.185003->0.338965
best_th=0.55, score up: 0.338965->0.577298
best_th=0.6, score up: 0.577298->0.627397
best_th=0.65, score up: 0.627397->0.648731
best_th=0.3, score up: 0.000000->0.187668
best_th=0.5, score up: 0.187668->0.332142
best_th=0.55, score up: 0.332142->0.559861
best_th=0.6, score up: 0.559861->0.602562
best_th=0.65, score up: 0.602562->0.624536
best_th=0.3, score up: 0.000000->0.110346
best_th=0.5, score up: 0.110346->0.210163
best_th=0.55, score up: 0.210163->0.579845
100%|██████████| 1/1 [00:00<00:00,  7.91it/s, epoch=2, gpu_mem=1.97 GB, loss=0.0111]
100%|██████████| 1/1 [00:00<00:00,  7.20it/s, epoch=2, gpu_mem=1.97 GB, loss=0.0089]
100%|██████████| 1/1 [00:00<00:00,  6.37it/s, epoch=2, gpu_mem=1.97 GB, loss=0.0040]
  0%|          | 0/1097 [00:00<?, ?it/s]



























































































































































































































































































100%|██████████| 1097/1097 [09:27<00:00,  1.93it/s, epoch=3, gpu_mem=22.84 GB, loss=0.0121, lr=3.00e-03]
valid:
best_th=0.3, score up: 0.000000->0.176796
best_th=0.5, score up: 0.176796->0.376717
best_th=0.55, score up: 0.376717->0.621182
best_th=0.6, score up: 0.621182->0.642690
100%|██████████| 1/1 [00:00<00:00,  8.15it/s, epoch=3, gpu_mem=1.97 GB, loss=0.0029]
100%|██████████| 1/1 [00:00<00:00,  8.16it/s, epoch=3, gpu_mem=1.97 GB, loss=0.0039]
100%|██████████| 1/1 [00:00<00:00,  8.15it/s, epoch=3, gpu_mem=1.97 GB, loss=0.0076]
100%|██████████| 1/1 [00:00<00:00,  7.62it/s, epoch=3, gpu_mem=1.97 GB, loss=0.0082]
100%|██████████| 1/1 [00:00<00:00,  6.94it/s, epoch=3, gpu_mem=1.97 GB, loss=0.0079]
best_th=0.3, score up: 0.000000->0.122219
best_th=0.5, score up: 0.122219->0.188384
best_th=0.55, score up: 0.188384->0.598417
best_th=0.6, score up: 0.598417->0.630556
best_th=0.65, score up: 0.630556->0.632752
best_th=0.3, score up: 0.000000->0.208335
best_th=0.5, score up: 0.208335->0.423979
best_th=0.55, score up: 0.423979->0.630407
best_th=0.6, score up: 0.630407->0.630858
best_th=0.3, score up: 0.000000->0.185003
best_th=0.5, score up: 0.185003->0.385530
best_th=0.55, score up: 0.385530->0.591842
best_th=0.6, score up: 0.591842->0.635201
best_th=0.65, score up: 0.635201->0.654806
best_th=0.3, score up: 0.000000->0.187668
best_th=0.5, score up: 0.187668->0.383149
best_th=0.55, score up: 0.383149->0.570329
best_th=0.6, score up: 0.570329->0.605732
best_th=0.65, score up: 0.605732->0.626909
best_th=0.3, score up: 0.000000->0.110346
best_th=0.5, score up: 0.110346->0.185683
best_th=0.55, score up: 0.185683->0.600152
best_th=0.6, score up: 0.600152->0.619571
100%|██████████| 1/1 [00:00<00:00,  6.43it/s, epoch=3, gpu_mem=1.97 GB, loss=0.0027]
  0%|          | 1/1097 [00:00<17:26,  1.05it/s, epoch=4, gpu_mem=22.84 GB, loss=0.0098, lr=3.00e-03]


























































































































































































































































































100%|██████████| 1097/1097 [09:26<00:00,  1.93it/s, epoch=4, gpu_mem=22.84 GB, loss=0.0095, lr=3.00e-03]
100%|██████████| 1/1 [00:00<00:00,  8.14it/s, epoch=4, gpu_mem=1.97 GB, loss=0.0025]
  0%|          | 0/1 [00:00<?, ?it/s, epoch=4, gpu_mem=1.97 GB, loss=0.0030]
valid:
best_th=0.3, score up: 0.000000->0.176796
best_th=0.5, score up: 0.176796->0.230182
best_th=0.55, score up: 0.230182->0.619866
best_th=0.6, score up: 0.619866->0.641321
best_th=0.65, score up: 0.641321->0.642667
best_th=0.3, score up: 0.000000->0.122219
best_th=0.5, score up: 0.122219->0.144568
best_th=0.55, score up: 0.144568->0.605335
best_th=0.6, score up: 0.605335->0.633032
best_th=0.65, score up: 0.633032->0.634257
best_th=0.3, score up: 0.000000->0.208335
best_th=0.5, score up: 0.208335->0.255985
best_th=0.55, score up: 0.255985->0.632668
100%|██████████| 1/1 [00:00<00:00,  8.04it/s, epoch=4, gpu_mem=1.97 GB, loss=0.0030]
100%|██████████| 1/1 [00:00<00:00,  7.50it/s, epoch=4, gpu_mem=1.97 GB, loss=0.0050]
100%|██████████| 1/1 [00:00<00:00,  6.86it/s, epoch=4, gpu_mem=1.97 GB, loss=0.0079]
100%|██████████| 1/1 [00:00<00:00,  6.22it/s, epoch=4, gpu_mem=1.97 GB, loss=0.0084]
100%|██████████| 1/1 [00:00<00:00,  6.11it/s, epoch=4, gpu_mem=1.97 GB, loss=0.0023]
best_th=0.3, score up: 0.000000->0.185003
best_th=0.5, score up: 0.185003->0.234891
best_th=0.55, score up: 0.234891->0.596495
best_th=0.6, score up: 0.596495->0.635443
best_th=0.65, score up: 0.635443->0.653012
best_th=0.3, score up: 0.000000->0.187668
best_th=0.5, score up: 0.187668->0.226496
best_th=0.55, score up: 0.226496->0.574380
best_th=0.6, score up: 0.574380->0.607955
best_th=0.65, score up: 0.607955->0.624151
best_th=0.3, score up: 0.000000->0.110346
best_th=0.5, score up: 0.110346->0.158126
best_th=0.55, score up: 0.158126->0.609338
best_th=0.6, score up: 0.609338->0.620390
train:


























































































































































































































































































100%|██████████| 1097/1097 [09:27<00:00,  1.93it/s, epoch=5, gpu_mem=22.84 GB, loss=0.0099, lr=3.00e-03]
100%|██████████| 1/1 [00:00<00:00,  8.36it/s, epoch=5, gpu_mem=1.97 GB, loss=0.0025]
  0%|          | 0/1 [00:00<?, ?it/s, epoch=5, gpu_mem=1.97 GB, loss=0.0029]
valid:
best_th=0.3, score up: 0.000000->0.176796
best_th=0.5, score up: 0.176796->0.176817
best_th=0.55, score up: 0.176817->0.612067
best_th=0.6, score up: 0.612067->0.639097
best_th=0.65, score up: 0.639097->0.646379
best_th=0.3, score up: 0.000000->0.122219
best_th=0.5, score up: 0.122219->0.122300
best_th=0.55, score up: 0.122300->0.594919
best_th=0.6, score up: 0.594919->0.630426
best_th=0.65, score up: 0.630426->0.640470
best_th=0.3, score up: 0.000000->0.208335
best_th=0.5, score up: 0.208335->0.208371
best_th=0.55, score up: 0.208371->0.629100
100%|██████████| 1/1 [00:00<00:00,  7.63it/s, epoch=5, gpu_mem=1.97 GB, loss=0.0029]
100%|██████████| 1/1 [00:00<00:00,  7.79it/s, epoch=5, gpu_mem=1.97 GB, loss=0.0028]
100%|██████████| 1/1 [00:00<00:00,  7.80it/s, epoch=5, gpu_mem=1.97 GB, loss=0.0095]
100%|██████████| 1/1 [00:00<00:00,  7.18it/s, epoch=5, gpu_mem=1.97 GB, loss=0.0099]
100%|██████████| 1/1 [00:00<00:00,  5.99it/s, epoch=5, gpu_mem=1.97 GB, loss=0.0012]
best_th=0.3, score up: 0.000000->0.185003
best_th=0.5, score up: 0.185003->0.185027
best_th=0.55, score up: 0.185027->0.584363
best_th=0.6, score up: 0.584363->0.627571
best_th=0.65, score up: 0.627571->0.653240
best_th=0.3, score up: 0.000000->0.187668
best_th=0.55, score up: 0.187668->0.565941
best_th=0.6, score up: 0.565941->0.601738
best_th=0.65, score up: 0.601738->0.624436
best_th=0.3, score up: 0.000000->0.110346
best_th=0.5, score up: 0.110346->0.110454
best_th=0.55, score up: 0.110454->0.601189
best_th=0.6, score up: 0.601189->0.623297
train:


























































































































































































































































































100%|██████████| 1097/1097 [09:27<00:00,  1.93it/s, epoch=6, gpu_mem=22.84 GB, loss=0.0094, lr=3.00e-03]
100%|██████████| 1/1 [00:00<00:00,  8.02it/s, epoch=6, gpu_mem=1.97 GB, loss=0.0050]
100%|██████████| 1/1 [00:00<00:00,  7.44it/s, epoch=6, gpu_mem=1.97 GB, loss=0.0063]
100%|██████████| 1/1 [00:00<00:00,  7.26it/s, epoch=6, gpu_mem=1.97 GB, loss=0.0026]
  0%|          | 0/1 [00:00<?, ?it/s, epoch=6, gpu_mem=1.97 GB, loss=0.0143]
valid:
best_th=0.3, score up: 0.000000->0.176796
best_th=0.5, score up: 0.176796->0.448472
best_th=0.55, score up: 0.448472->0.596098
best_th=0.6, score up: 0.596098->0.629508
best_th=0.65, score up: 0.629508->0.644447
best_th=0.3, score up: 0.000000->0.122219
best_th=0.5, score up: 0.122219->0.424073
best_th=0.55, score up: 0.424073->0.573469
best_th=0.6, score up: 0.573469->0.612419
best_th=0.65, score up: 0.612419->0.636188
100%|██████████| 1/1 [00:00<00:00,  7.24it/s, epoch=6, gpu_mem=1.97 GB, loss=0.0143]
100%|██████████| 1/1 [00:00<00:00,  6.74it/s, epoch=6, gpu_mem=1.97 GB, loss=0.0141]
100%|██████████| 1/1 [00:00<00:00,  6.22it/s, epoch=6, gpu_mem=1.97 GB, loss=0.0027]
  0%|          | 0/1097 [00:00<?, ?it/s]
best_th=0.5, score up: 0.208335->0.487910
best_th=0.55, score up: 0.487910->0.619663
best_th=0.6, score up: 0.619663->0.637855
best_th=0.3, score up: 0.000000->0.185003
best_th=0.5, score up: 0.185003->0.418565
best_th=0.55, score up: 0.418565->0.566478
best_th=0.6, score up: 0.566478->0.611966
best_th=0.65, score up: 0.611966->0.644252
best_th=0.3, score up: 0.000000->0.187668
best_th=0.5, score up: 0.187668->0.403667
best_th=0.55, score up: 0.403667->0.550015
best_th=0.6, score up: 0.550015->0.588066
best_th=0.65, score up: 0.588066->0.617191
best_th=0.3, score up: 0.000000->0.110346
best_th=0.5, score up: 0.110346->0.418887
best_th=0.55, score up: 0.418887->0.580029
best_th=0.6, score up: 0.580029->0.613995
best_th=0.65, score up: 0.613995->0.623633



























































































































































































































































































100%|█████████▉| 1096/1097 [09:26<00:00,  1.94it/s, epoch=7, gpu_mem=22.84 GB, loss=0.0081, lr=3.00e-03]
valid:
best_th=0.3, score up: 0.000000->0.176796
best_th=0.5, score up: 0.176796->0.323351
best_th=0.55, score up: 0.323351->0.619285
best_th=0.6, score up: 0.619285->0.642095
best_th=0.65, score up: 0.642095->0.646016
best_th=0.3, score up: 0.000000->0.122219
best_th=0.5, score up: 0.122219->0.371875
best_th=0.55, score up: 0.371875->0.610264
best_th=0.6, score up: 0.610264->0.637408
best_th=0.65, score up: 0.637408->0.639456
best_th=0.3, score up: 0.000000->0.208335
best_th=0.5, score up: 0.208335->0.333213
best_th=0.55, score up: 0.333213->0.633222
100%|██████████| 1097/1097 [09:27<00:00,  1.93it/s, epoch=7, gpu_mem=22.84 GB, loss=0.0082, lr=3.00e-03]
100%|██████████| 1/1 [00:00<00:00,  7.46it/s, epoch=7, gpu_mem=1.97 GB, loss=0.0017]
100%|██████████| 1/1 [00:00<00:00,  8.11it/s, epoch=7, gpu_mem=1.97 GB, loss=0.0019]
100%|██████████| 1/1 [00:00<00:00,  8.15it/s, epoch=7, gpu_mem=1.97 GB, loss=0.0025]
100%|██████████| 1/1 [00:00<00:00,  7.74it/s, epoch=7, gpu_mem=1.97 GB, loss=0.0083]
  0%|          | 0/1 [00:00<?, ?it/s]
best_th=0.3, score up: 0.000000->0.185003
best_th=0.5, score up: 0.185003->0.284197
best_th=0.55, score up: 0.284197->0.589887
best_th=0.6, score up: 0.589887->0.631088
best_th=0.65, score up: 0.631088->0.655154
best_th=0.3, score up: 0.000000->0.187668
best_th=0.5, score up: 0.187668->0.311002
best_th=0.55, score up: 0.311002->0.582347
best_th=0.6, score up: 0.582347->0.614518
best_th=0.65, score up: 0.614518->0.631469
best_th=0.3, score up: 0.000000->0.110346
best_th=0.5, score up: 0.110346->0.385171
best_th=0.55, score up: 0.385171->0.607716
best_th=0.6, score up: 0.607716->0.624931
100%|██████████| 1/1 [00:00<00:00,  6.56it/s, epoch=7, gpu_mem=1.97 GB, loss=0.0052]
100%|██████████| 1/1 [00:00<00:00,  6.10it/s, epoch=7, gpu_mem=1.97 GB, loss=0.0010]










































































































































































































































































